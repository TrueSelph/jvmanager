import{w as d,C as g,y as h,a as p}from"./chunk-QMGIS6GS-CBZUm-7V.js";import{j as a}from"./jsx-runtime-D_zvdyIk.js";import{B as u}from"./polymorphic-factory-aZn9nhyV.js";import{G as f}from"./Group-BgvTqR_9.js";import{T as b}from"./Title-DsPuOqIQ.js";import{B as I}from"./Button-BH1hN9oM.js";import{c as x}from"./createReactComponent-CwEnMXT7.js";import{D as j}from"./Divider-C0Sq59zE.js";import{C as w}from"./Card-Bkt36yw-.js";import"./Loader-BKuNbySO.js";import"./index-B4z8r-Ct.js";import"./Paper-CnFb9jmT.js";import"./create-safe-context-CzEsa9t0.js";/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var y=x("outline","eraser","IconEraser",[["path",{d:"M19 20h-10.5l-4.21 -4.3a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9.2 9.3",key:"svg-0"}],["path",{d:"M18 13.3l-6.3 -6.3",key:"svg-1"}]]);async function J(){var n;const r=localStorage.getItem("jivas-token")||"",e=localStorage.getItem("jivas-host")||"",o=localStorage.getItem("jivas-agent")||"",s=(n=document.cookie.match(/tsSessionId=([^;]+)/))==null?void 0:n[1],t=s&&s!=="undefined"?s:crypto.randomUUID();return await fetch(`${e}/walker/add_frame`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({agent_id:o,session_id:t})}),{sessionId:t,host:localStorage.getItem("jivas-host")||"",agentId:localStorage.getItem("jivas-agent")||""}}async function N({context:r,request:e}){const o=await e.formData(),s=o.get("_action"),t=new FormData,n=o.get("agentId")||"",i=localStorage.getItem("jivas-token")||"",c=localStorage.getItem("jivas-host")||"",l=o.get("sessionId");if(s==="wipeAgentMemory")return t.append("args",JSON.stringify({session_id:l})),t.append("module_root","actions.jivas.agent_utils_action"),t.append("agent_id",n),t.append("walker","purge_frame_memory"),await fetch(`${c}/action/walker`,{method:"POST",headers:{Authorization:`Bearer ${i}`},body:t}).then(async m=>await m.json())}function P(){return[{title:"Chat | JIVAS Manager"}]}const $=d(function({loaderData:e}){const{selectedAgentInfo:o}=g(),s=h(),t=p.useCallback(()=>{const n=new CustomEvent("tsmclearmessages");s.submit({_action:"wipeAgentMemory",agentId:e.agentId||"",sessionId:e.sessionId||""},{method:"POST"}),window.dispatchEvent(n)},[]);return a.jsxs(u,{py:"xl",px:"xl",children:[a.jsxs(f,{justify:"space-between",children:[a.jsx(b,{order:3,children:"Chat"}),a.jsx(I,{color:"dark",leftSection:a.jsx(y,{className:"h-5 w-5"}),size:"xs",onClick:t,loading:s.state!=="idle",children:"Clear Chat Memory"})]}),a.jsx(j,{mt:"xs",mb:"xl"}),a.jsx(w,{px:"xl",h:"80vh",withBorder:!0,children:a.jsx("ts-messenger",{host:e.host,"agent-id":e.agentId,"agent-name":o==null?void 0:o.name,theme:JSON.stringify({"--ts-chat-bg":"white","--ts-chat-fg":"black","--ts-chat-popup-bg":"white","--ts-icon-btn-bg":"transparent","--ts-icon-btn-hover-bg":"#E4E4E7","--ts-input-btn-color":"black","--ts-input-bg":"#dbdbdb42","--ts-input-bd":"#D4D4D8","--ts-chat-bd":"#D4D4D8","--chakra-colors-border":"#D4D4D8","--ts-input-color":"black","--ts-input-placeholder-color":"#000000eb","--ts-response-msg-color":"black"}),"with-debug":"true",layout:"standard","session-id":e.sessionId||"","use-local-storage-cache":"true",style:{height:"100%"}})})]})});export{N as clientAction,J as clientLoader,$ as default,P as meta};
