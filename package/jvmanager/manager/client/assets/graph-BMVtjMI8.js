import{w as j,z as u}from"./chunk-QMGIS6GS-CBZUm-7V.js";import{j as t}from"./jsx-runtime-D_zvdyIk.js";import{U as x}from"./UserButton-BgrqSuIY.js";import{B as d}from"./polymorphic-factory-EW0USS3V.js";import{G as g}from"./Group-bnACpcuK.js";import{A as w}from"./ActionIcon-BO4DDcDR.js";import{I as b}from"./IconArrowLeft-4qKQ7vAI.js";import{T as y}from"./Title-B0fFn55O.js";import{D as S}from"./Divider-BI4N1hoX.js";import{C as v}from"./Card-BHrMkZ_V.js";import"./Avatar-BMARKXxx.js";import"./Input-I-MjqIR2.js";import"./CloseButton-BDZlzHA2.js";import"./Loader-1VreoqJz.js";import"./index-B4z8r-Ct.js";import"./events-BOd7YSSb.js";import"./Text-CkpJSrnl.js";import"./Stack-BsPYYAFq.js";import"./createReactComponent-CwEnMXT7.js";import"./Button-BhC08Y9X.js";import"./Paper-k397c_lM.js";import"./create-safe-context-CzEsa9t0.js";function V(){return[{title:"Actions | JIVAS Manager"}]}async function H({request:f}){var m,c,l,h;const e=localStorage.getItem("jivas-host"),n=localStorage.getItem("jivas-token"),p=localStorage.getItem("jivas-agent"),r=p?await fetch(`${e}/walker/get_agent`,{method:"POST",body:JSON.stringify({agent_id:p}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}}).then(s=>s.json()):null,a=new FormData;a.append("args",'{"base64_prefix": false}'),a.append("module_root","actions.jivas.avatar_action"),a.append("agent_id",((c=(m=r==null?void 0:r.reports)==null?void 0:m[0])==null?void 0:c.id)||""),a.append("walker","get_avatar");const o=await fetch(`${e}/action/walker`,{method:"POST",headers:{Authorization:`Bearer ${n}`},body:a}).then(async s=>await s.json()).catch(()=>null),i=await fetch(`${e}/walker/list_agents`,{method:"POST",body:JSON.stringify({}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}}).then(s=>s.json()).catch(()=>({reports:[]}));return{selectedAgentInfo:{...((l=r==null?void 0:r.reports)==null?void 0:l[0])||{},thumbnail:!((h=o==null?void 0:o.includes)!=null&&h.call(o,"unable"))&&o&&typeof o=="string"?`data:image/png;base64,${o}`:""},agents:i==null?void 0:i.reports}}const K=j(function({loaderData:e}){const n=localStorage.getItem("jivas-host");return localStorage.getItem("jivas-token"),t.jsxs(d,{px:"xl",children:[t.jsxs(g,{justify:"space-between",children:[t.jsxs(g,{children:[t.jsx(w,{color:"dark",size:"sm",component:u,to:"/dashboard",children:t.jsx(b,{})}),t.jsx(y,{order:3,children:"Graph"})]}),t.jsx(d,{children:t.jsx(x,{selectedAgentInfo:e.selectedAgentInfo||null,agents:e.agents})})]}),t.jsx(S,{mt:"xs",mb:"sm"}),t.jsx(v,{px:"0",py:"0",h:"86vh",withBorder:!0,pos:"relative",children:t.jsx("jvgraph-viewer",{className:"min-h-[740px]",host:n,root_node:"dfdf",host:"http://localhost:8000",root_node:"68791bfaaf057b330ac55e15",style:{width:"100%",height:"100%",border:"none",outline:"none"}},e.selectedAgentInfo.id)})]})});export{H as clientLoader,K as default,V as meta};
